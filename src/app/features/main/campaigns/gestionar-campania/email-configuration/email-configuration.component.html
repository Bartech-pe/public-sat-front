<div class="container mx-auto p-6 bg-white shadow-lg rounded-lg">
  <h2 class="text-3xl font-bold text-gray-800 mb-6">Configuración de Campaña de Correo</h2>

  <!-- Formulario -->
  <form [formGroup]="emailForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
    <div>
      <label for="asunto" class="block text-sm font-medium text-gray-700 mb-1">Asunto</label>
      <input pInputText id="asunto" formControlName="asunto" class="w-full p-2 border rounded-md" placeholder="Asunto del correo" />
      <small *ngIf="emailForm.get('asunto')?.invalid && emailForm.get('asunto')?.touched" class="text-red-500">
        El asunto es obligatorio y debe tener al menos 5 caracteres.
      </small>
    </div>
    <div>
      <label for="remitente" class="block text-sm font-medium text-gray-700 mb-1">Remitente</label>
      <input pInputText id="remitente" formControlName="remitente" class="w-full p-2 border rounded-md" placeholder="correo@ejemplo.com" />
      <small *ngIf="emailForm.get('remitente')?.invalid && emailForm.get('remitente')?.touched" class="text-red-500">
        Ingresa un correo válido.
      </small>
    </div>
    <div>
      <label for="plantilla" class="block text-sm font-medium text-gray-700 mb-1">Plantilla</label>
      <p-dropdown formControlName="plantilla" [options]="plantillas" optionLabel="nombre" class="w-full"></p-dropdown>
    </div>
  </form>

  <!-- Subida de Excel -->
  <div class="mb-6">
    <h3 class="text-xl font-semibold text-gray-800 mb-2">Cargar Contactos</h3>
    <p-fileUpload mode="basic" (onSelect)="onUploadContactos($event)" accept=".xlsx,.xls" chooseLabel="Subir Excel" class="inline-block" />
  </div>

  <!-- Tabla de Contactos -->
  <p-table [value]="contactos()" [responsive]="true" class="mb-6">
    <ng-template pTemplate="header">
      <tr>
        <th class="p-2">Nombre</th>
        <th class="p-2">Email</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-contacto>
      <tr>
        <td class="p-2">{{ contacto.nombre }}</td>
        <td class="p-2">{{ contacto.email }}</td>
      </tr>
    </ng-template>
  </p-table>

  <!-- Subida de Adjuntos -->
  <div class="mb-6">
    <h3 class="text-xl font-semibold text-gray-800 mb-2">Adjuntos</h3>
    <p-fileUpload mode="basic" multiple="true" (onSelect)="onUploadAdjuntos($event)" chooseLabel="Subir Adjuntos" class="inline-block mb-2" />
    <div *ngIf="adjuntos().length" class="flex flex-wrap gap-2">
      <div *ngFor="let file of adjuntos()" class="flex items-center p-2 bg-gray-100 rounded-md">
        <span>{{ file.name }}</span>
        <button pButton icon="pi pi-trash" class="ml-2 p-button-danger p-button-sm" (click)="removeAdjunto(file)"></button>
      </div>
    </div>
  </div>

  <!-- Editor de Plantilla -->
  <div class="mb-6">
    <h3 class="text-xl font-semibold text-gray-800 mb-2">Editar Plantilla</h3>
    <p-editor
      [(ngModel)]="emailForm.value.plantilla.html"
      (ngModelChange)="updatePlantillaHtml($event)"
      [style]="{height:'320px'}"
      class="w-full"
    ></p-editor>
  </div>

  <!-- Botón de Previsualización -->
  <p-button label="Previsualizar Correo" icon="pi pi-eye" (onClick)="previsualizarCorreo()" class="mb-6 bg-blue-600 hover:bg-blue-700 text-white"></p-button>

  <!-- Vista Previa -->
  <div *ngIf="previewHtml" class="border p-6 bg-gray-50 rounded-lg shadow-sm">
    <h3 class="text-xl font-semibold text-gray-800 mb-2">Vista Previa del Correo</h3>
    <div class="max-h-96 overflow-y-auto" [innerHTML]="previewHtml"></div>
  </div>

</div>