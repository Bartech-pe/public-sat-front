<div class="grid grid-cols-1 gap-4">
  <!-- Encabezado -->
  <div class="shadow-lg rounded-xl p-4 mb-4 bg-gray-50">
    <div class="flex justify-between">
      <h5 class="text-2xl font-semibold">Gestión de Canales - AloSAT</h5>
    </div>

    <div class="flex flex-col w-full gap-3 text-n-slate-11">
      <p
        class="mb-0 text-sm font-normal line-clamp-5 sm:line-clamp-none max-w-3xl text-gray-600"
      >
        Supervisor: Pedro Sánchez - Subgerencia de Orientación y Registro
      </p>
    </div>
  </div>

  <!-- Tarjetas resumen -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <p-card class="text-center">
      <ng-template pTemplate="title">
        <h3 class="uppercase text-base font-bold">Total Asesores</h3>
      </ng-template>
      <ng-template pTemplate="content">
        <p class="text-xl font-bold">{{ listaAsesores.length }}</p>
        <p class="text-gray-500 text-sm">Miembros del equipo</p>
      </ng-template>
    </p-card>

    <p-card class="text-center">
      <ng-template pTemplate="title">
        <h3 class="uppercase text-base font-bold">
          Canales Activos
        </h3></ng-template
      >
      <ng-template pTemplate="content">
        <p class="text-xl font-bold">3</p>
        <p class="text-gray-500 text-sm">Canales en uso</p>
      </ng-template>
    </p-card>

    <!-- <p-card class="text-center">
      <ng-template pTemplate="title"
        ><h3 class="uppercase text-base font-bold">
          Asesores En Llamada
        </h3></ng-template
      >
      <ng-template pTemplate="content">
        <p class="text-xl font-bold text-green-600">2</p>
        <p class="text-gray-500 text-sm">Disponibles o en atención</p>
      </ng-template>
    </p-card>

    <p-card class="text-center">
      <ng-template pTemplate="title"
        ><h3 class="uppercase text-base font-bold">
          Cola de Espera
        </h3></ng-template
      >
      <ng-template pTemplate="content">
        <p class="text-xl font-bold text-red-500">5</p>
        <p class="text-gray-500 text-sm">Interacciones pendientes</p>
      </ng-template>
    </p-card> -->
  </div>

  <ng-container *ngIf="!loading">
    <!-- Tabs de canales -->
    <p-tabs [value]="value">
      <p-tablist>
        <p-tab [value]="0" class="flex items-center"
          ><iconify-icon [icon]="'line-md:phone-call-loop'" class="text-xl" />
          <span>Telefónico</span></p-tab
        >
        <!-- <p-tab [value]="1" class="flex items-center">
        <iconify-icon [icon]="'line-md:chat'" class="text-xl" />
        <span>ChatSAT</span>
      </p-tab>
      <p-tab [value]="2" class="flex items-center"
        ><iconify-icon [icon]="'line-md:email'" class="text-xl" />
        <span>Email</span>
      </p-tab> -->
        <p-tab [value]="3" class="flex items-center">
          <iconify-icon [icon]="'ic:outline-whatsapp'" class="text-xl" />
          <span>WhatsApp</span>
        </p-tab>
        <p-tab [value]="4" class="flex items-center">
          <iconify-icon [icon]="'line-md:telegram'" class="text-xl" />
          <span>Telegram</span>
        </p-tab>
      </p-tablist>
      <p-tabpanels>
        <p-tabpanel [value]="0">
          <div class="grid grid-cols-1 gap-6">
            <div class="col-span-2">
              <p-card>
                <h3 class="text-xl font-bold">Asesores Disponibles</h3>
                <p class="text-sm mb-4">
                  Gestiona el estado y asignación de tus asesores
                </p>
                <div class="grid grid-cols-2 items-center gap-4 mb-6">
                  <div class="col-span-2">
                    <input
                      type="text"
                      pInputText
                      placeholder="Buscar asesor..."
                      class="w-full"
                    />
                  </div>
                  <!-- <p-select [options]="[]" placeholder="Todos"></p-select>
                <p-select [options]="[]" placeholder="Todos"></p-select> -->
                </div>

                <p-accordion [value]="0">
                  @for (tab of listaAsesores; track tab.name) {
                  <p-accordion-panel [value]="tab.id">
                    <p-accordion-header
                      ><span class="flex items-center gap-2 w-full">
                        <p-avatar
                          class="bg-slate-200"
                          size="normal"
                          shape="circle"
                        >
                          <p-image
                            *ngIf="tab.avatarUrl"
                            [src]="tab.avatarUrl"
                            [alt]="tab.name"
                          />
                          <span
                            class="font-bold text-sm"
                            *ngIf="!tab.avatarUrl"
                          >
                            {{ getInitial(tab) }}
                          </span>
                        </p-avatar>
                        <span class="font-bold whitespace-nowrap">{{
                          tab.displayName
                        }}</span>
                      </span></p-accordion-header
                    >
                    <p-accordion-content>
                      <div class="flex-col">
                        <div class="border-b border-gray-300 py-2">
                          <p class="text-base text-gray-500">
                            {{ tab.email }}
                          </p>
                          <!-- <p class="text-base text-gray-500">
                          {{ tab.celular }}
                        </p> -->
                        </div>
                        <div class="border-b border-gray-300 py-2">
                          <p class="font-semibold mb-2">Canales Activos:</p>

                          <ul
                            class="grid grid-cols-2 text-sm space-y-2"
                            *ngIf="tab.inboxes?.length > 0; else sinCanales"
                          >
                            <li
                              class="flex items-center gap-2"
                              *ngFor="let itemInbox of tab.inboxes"
                            >
                              <iconify-icon
                                [icon]="'icon-park-outline:check-one'"
                                class="text-lg text-green-500"
                              ></iconify-icon>
                              <span>{{ itemInbox.name }}</span>
                            </li>
                          </ul>

                          <!-- Plantilla alternativa si está vacío -->
                          <ng-template #sinCanales>
                            <p class="text-sm text-gray-500 italic">
                              Aún no tiene asignado ningún canal.
                            </p>
                          </ng-template>
                        </div>
                        <div class="border-b border-gray-300 py-4">
                          <div class="flex justify-between items-center">
                            <div>
                              <p class="text-lg font-semibold">Estado:</p>
                            </div>
                            <div>
                              <p-tag
                                [value]="tab.estado"
                                [severity]="
                                  tab.estado == 'En Llamada'
                                    ? 'success'
                                    : tab.estado == 'Fuera de Línea'
                                    ? 'warn'
                                    : tab.estado == 'Disponible'
                                    ? 'info'
                                    : 'danger'
                                "
                                class="text-xs"
                              />
                            </div>
                            <div>
                              <p-button
                                size="small"
                                label="Cambiar"
                                styleClass="w-full !rounded-full !shadow-none"
                                severity="info"
                                variant="outlined"
                                (click)="modalCambiarEstado(tab)"
                              >
                                <iconify-icon
                                  [icon]="'ooui:recent-changes-ltr'"
                                  class="text-lg"
                                />
                              </p-button>
                            </div>
                          </div>
                        </div>
                        <div class="flex items-center pt-4 gap-4">
                          <p-button
                            size="small"
                            label="Asignar Canal"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="info"
                            variant="outlined"
                            (click)="modalAsignarCanal(tab)"
                          >
                            <iconify-icon
                              [icon]="
                                'material-symbols:assignment-turned-in-outline-rounded'
                              "
                              class="text-xl"
                            />
                          </p-button>
                          <!-- <p-button
                          size="small"
                          label="Ver historial"
                          styleClass="w-full"
                          severity="contrast"
                          variant="outlined"
                          (onClick)="modalVerHistorial(tab.asesor)"
                        >
                          <iconify-icon
                            [icon]="'weui:eyes-on-outlined'"
                            class="text-xl"
                          />
                        </p-button> -->
                        </div>
                      </div>
                    </p-accordion-content>
                  </p-accordion-panel>
                  }
                </p-accordion>
              </p-card>
            </div>
            <!-- <div class="col-span-4">
            <p-card>
              <ng-template pTemplate="title">
                <div class="text-lg font-semibold">
                  Asignación Actual - Canal: Telefónico
                </div>
              </ng-template>
              <ng-template pTemplate="content">
                <p class="text-sm text-gray-500 mb-4">
                  Gestiona los turnos y la cola de llamadas.
                </p>


                <div
                  *ngFor="let item of listaTurnos"
                  class="mb-6 rounded-xl border border-gray-300 p-4"
                >
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="font-semibold">{{ item.turno }}</h3>
                    <p-button
                      size="small"
                      label="Configurar"
                      [raised]="true"
                      styleClass="w-full"
                      severity="info"
                    >
                      <iconify-icon
                        [icon]="'solar:settings-linear'"
                        class="text-xl"
                      />
                    </p-button>
                  </div>
                  <div
                    class="space-y-2"
                    *ngIf="item.asesores.length > 0; else sinAsesores"
                  >

                    <div
                      *ngFor="let asesor of item.asesores"
                      class="flex items-center justify-between p-3 border rounded-md border-gray-300"
                    >
                      <div class="flex items-center gap-2">
                        <p-badge
                          [severity]="
                            asesor.estado == 'En Llamada'
                              ? 'success'
                              : asesor.estado == 'Fuera de Línea'
                              ? 'warn'
                              : asesor.estado == 'Disponible'
                              ? 'info'
                              : 'danger'
                          "
                        />
                        <span>{{ asesor.asesor }}</span>
                      </div>
                      <div class="flex items-center gap-3">
                        <p-tag
                          [value]="asesor.estado"
                          [severity]="
                            asesor.estado == 'En Llamada'
                              ? 'success'
                              : asesor.estado == 'Fuera de Línea'
                              ? 'warn'
                              : asesor.estado == 'Disponible'
                              ? 'info'
                              : 'danger'
                          "
                          class="text-xs"
                        />
                        <p-button
                          size="small"
                          label="Cambiar"
                          styleClass="w-full"
                          severity="info"
                          variant="outlined"
                          (click)="modalCambiarEstado(asesor)"
                        >
                          <iconify-icon
                            [icon]="'ooui:recent-changes-ltr'"
                            class="text-lg"
                          />
                        </p-button>
                      </div>
                    </div>
                  </div>
                  <ng-template #sinAsesores>
                    <div
                      class="flex items-center justify-between p-3 border border-gray-400 rounded-md text-gray-300 italic"
                    >
                      <div class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-gray-400"></span>
                        <span>(Vacante)</span>
                      </div>
                      <p-button
                        size="small"
                        label="Asignar"
                        styleClass="w-full"
                        severity="secondary"
                        variant="outlined"
                      >
                        <iconify-icon
                          [icon]="'pajamas:assignee'"
                          class="text-lg"
                        />
                      </p-button>
                    </div>
                  </ng-template>
                </div>
              </ng-template>
            </p-card>

          <div>
              <p-card>
                <ng-template pTemplate="title">
                  <div class="text-lg font-semibold">
                    Cola Actual - Canal: Telefónico
                  </div>
                </ng-template>
                <ng-template pTemplate="content">
                  <p class="text-sm text-gray-500 mb-4">
                    Monitoreo en tiempo real de llamadas en espera
                  </p>
                  <div></div>
                  <div>
                    <p-table
                      [value]="listadoLlamadasEspera"
                      [paginator]="true"
                      [rows]="10"
                      [responsiveLayout]="'scroll'"
                      [rowsPerPageOptions]="[5, 10, 20]"
                      [showCurrentPageReport]="true"
                      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} entradas"
                    >
                      <ng-template pTemplate="header">
                        <tr>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Id
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Contribuyente
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Categoria
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex justify-center items-center text-xs uppercase gap-4"
                            >
                              Tiempo de cola
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex justify-center items-center text-xs uppercase gap-4"
                            >
                              Acciones
                            </div>
                          </th>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="body" let-item>
                        <tr>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.id }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.contribuyente }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.category }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light text-center">
                              {{ item.tiempoCola }}
                            </p>
                          </td>
                          <td>
                            <div
                              *ngIf="item.id !== 1"
                              class="flex justify-center items-center gap-1"
                            >
                              <button-edit (click)="edit(item)" />
                              <btn-delete (click)="remove(item)" />
                            </div>
                          </td>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="emptymessage">
                        <tr>
                          <td colspan="7" class="text-center p-6">
                            <div
                              class="flex flex-col items-center text-gray-500"
                            >
                              <i
                                class="pi pi-folder-open text-6xl text-gray-400"
                              ></i>
                              <p class="text-lg font-medium mt-3">
                                Sin Llamadas en espera
                              </p>
                            </div>
                          </td>
                        </tr>
                      </ng-template>
                    </p-table>
                  </div>
                </ng-template>
              </p-card>
            </div>
          </div> -->
          </div>
        </p-tabpanel>
        <p-tabpanel [value]="1">
          <div class="grid grid-cols-6 gap-6">
            <div class="col-span-2">
              <p-card>
                <h3 class="text-lg font-semibold">Asesores Disponibles</h3>
                <p class="text-sm mb-4">
                  Gestiona el estado y asignación de tus asesores
                </p>
                <div class="grid grid-cols-2 items-center gap-4 mb-6">
                  <div class="col-span-2">
                    <input
                      type="text"
                      pInputText
                      placeholder="Buscar asesor..."
                      class="w-full"
                    />
                  </div>
                  <!-- <p-select [options]="[]" placeholder="Todos"></p-select>
                <p-select [options]="[]" placeholder="Todos"></p-select> -->
                </div>

                <p-accordion [value]="0">
                  @for (tab of listaAsesores; track tab.name) {
                  <p-accordion-panel [value]="tab.id">
                    <p-accordion-header
                      ><span class="flex items-center gap-2 w-full">
                        <p-avatar [image]="tab.avatarUrl" shape="circle" />
                        <span class="font-bold whitespace-nowrap">{{
                          tab.name
                        }}</span>
                      </span></p-accordion-header
                    >
                    <p-accordion-content>
                      <div class="flex-col">
                        <div class="border-b border-gray-300 py-2">
                          <p class="text-base text-gray-500">
                            {{ tab.email }}
                          </p>
                          <!-- <p class="text-base text-gray-500">
                            {{ tab.celular }}
                          </p> -->
                        </div>
                        <div class="border-b border-gray-300 py-2">
                          <p class="font-semibold mb-2">Canales Activos:</p>

                          <ul
                            class="grid grid-cols-2 text-sm space-y-2"
                            *ngIf="tab.inboxes?.length > 0; else sinCanales"
                          >
                            <li
                              class="flex items-center gap-2"
                              *ngFor="let itemInbox of tab.inboxes"
                            >
                              <iconify-icon
                                [icon]="'icon-park-outline:check-one'"
                                class="text-lg text-green-500"
                              ></iconify-icon>
                              <span>{{ itemInbox.name }}</span>
                            </li>
                          </ul>

                          <!-- Plantilla alternativa si está vacío -->
                          <ng-template #sinCanales>
                            <p class="text-sm text-gray-500 italic">
                              Aún no tiene asignado ningún canal.
                            </p>
                          </ng-template>
                        </div>
                        <div class="border-b border-gray-300 py-4">
                          <div class="flex justify-between items-center">
                            <div>
                              <p class="text-lg font-semibold">Estado:</p>
                            </div>
                            <div>
                              <p-tag
                                [value]="tab.estado"
                                [severity]="
                                  tab.estado == 'En Llamada'
                                    ? 'success'
                                    : tab.estado == 'Fuera de Línea'
                                    ? 'warn'
                                    : tab.estado == 'Disponible'
                                    ? 'info'
                                    : 'danger'
                                "
                                class="text-xs"
                              />
                            </div>
                            <div>
                              <p-button
                                size="small"
                                label="Cambiar"
                                styleClass="w-full !rounded-full !shadow-none"
                                severity="info"
                                variant="outlined"
                                (click)="modalCambiarEstado(tab)"
                              >
                                <iconify-icon
                                  [icon]="'ooui:recent-changes-ltr'"
                                  class="text-lg"
                                />
                              </p-button>
                            </div>
                          </div>
                        </div>
                        <div class="flex items-center pt-4 gap-4">
                          <p-button
                            size="small"
                            label="Asignar Canal"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="info"
                            variant="outlined"
                            (click)="modalAsignarCanal(tab)"
                          >
                            <iconify-icon
                              [icon]="
                                'material-symbols:assignment-turned-in-outline-rounded'
                              "
                              class="text-xl"
                            />
                          </p-button>
                          <p-button
                            size="small"
                            label="Ver historial"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="contrast"
                            variant="outlined"
                            (onClick)="modalVerHistorial(tab.asesor)"
                          >
                            <iconify-icon
                              [icon]="'weui:eyes-on-outlined'"
                              class="text-xl"
                            />
                          </p-button>
                        </div>
                      </div>
                    </p-accordion-content>
                  </p-accordion-panel>
                  }
                </p-accordion>
              </p-card>
            </div>
            <div class="col-span-4">
              <p-card>
                <ng-template pTemplate="title">
                  <div class="text-lg font-semibold">
                    Metricas del Canal: Chat SAT
                  </div>
                </ng-template>
                <ng-template pTemplate="content">
                  <p class="text-sm text-gray-500 mb-4">
                    Chats pendientes de asignación
                  </p>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <p-card class="text-center">
                      <ng-template pTemplate="title">
                        <h3 class="uppercase text-base font-bold">
                          Chats Activos
                        </h3>
                      </ng-template>
                      <ng-template pTemplate="content">
                        <p class="text-xl font-bold">2</p>
                        <p class="text-gray-500 text-sm">En curso</p>
                      </ng-template>
                    </p-card>

                    <p-card class="text-center">
                      <ng-template pTemplate="title">
                        <h3 class="uppercase text-base font-bold">
                          Tiempo Promedio Respuesta
                        </h3></ng-template
                      >
                      <ng-template pTemplate="content">
                        <p class="text-xl font-bold">33.3 s</p>
                        <p class="text-gray-500 text-sm">Última hora</p>
                      </ng-template>
                    </p-card>
                  </div>
                  <div>
                    <p-card class="mt-4">
                      <ng-template pTemplate="title">
                        <div class="text-lg font-semibold">
                          Cola de Espera: ChatSAT
                        </div>
                      </ng-template>
                      <ng-template pTemplate="content">
                        <p class="text-sm text-gray-500 mb-4">
                          Chats pendientes de asignación
                        </p>
                        <div></div>
                        <div>
                          <p-table
                            [value]="listadoLlamadasEspera"
                            [paginator]="true"
                            [rows]="10"
                            [responsiveLayout]="'scroll'"
                            [rowsPerPageOptions]="[5, 10, 20]"
                            [showCurrentPageReport]="true"
                            currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} entradas"
                          >
                            <ng-template pTemplate="header">
                              <tr>
                                <th>
                                  <div
                                    class="flex items-center text-xs uppercase gap-4"
                                  >
                                    Id
                                  </div>
                                </th>
                                <th>
                                  <div
                                    class="flex items-center text-xs uppercase gap-4"
                                  >
                                    Contribuyente
                                  </div>
                                </th>
                                <th>
                                  <div
                                    class="flex items-center text-xs uppercase gap-4"
                                  >
                                    Categoria
                                  </div>
                                </th>
                                <th>
                                  <div
                                    class="flex justify-center items-center text-xs uppercase gap-4"
                                  >
                                    Tiempo de cola
                                  </div>
                                </th>
                                <th>
                                  <div
                                    class="flex justify-center items-center text-xs uppercase gap-4"
                                  >
                                    Acciones
                                  </div>
                                </th>
                              </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-item>
                              <tr>
                                <td>
                                  <p class="text-sm font-light">
                                    {{ item.id }}
                                  </p>
                                </td>
                                <td>
                                  <p class="text-sm font-light">
                                    {{ item.contribuyente }}
                                  </p>
                                </td>
                                <td>
                                  <p class="text-sm font-light">
                                    {{ item.category }}
                                  </p>
                                </td>
                                <td>
                                  <p class="text-sm font-light text-center">
                                    {{ item.tiempoCola }}
                                  </p>
                                </td>
                                <td></td>
                              </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                              <tr>
                                <td colspan="7" class="text-center p-6">
                                  <div
                                    class="flex flex-col items-center text-gray-500"
                                  >
                                    <i
                                      class="pi pi-folder-open text-6xl text-gray-400"
                                    ></i>
                                    <p class="text-lg font-medium mt-3">
                                      Sin Llamadas en espera
                                    </p>
                                  </div>
                                </td>
                              </tr>
                            </ng-template>
                          </p-table>
                        </div>
                      </ng-template>
                    </p-card>
                  </div>
                </ng-template>
              </p-card>

              <!-- Cola de espera ChatSAT-->
            </div>
          </div>
        </p-tabpanel>
        <p-tabpanel [value]="2">
          <div class="grid grid-cols-6 gap-6">
            <div class="col-span-2">
              <p-card>
                <h3 class="text-lg font-semibold">Asesores Disponibles</h3>
                <p class="text-sm mb-4">
                  Gestiona el estado y asignación de tus asesores
                </p>
                <div class="grid grid-cols-2 items-center gap-4 mb-6">
                  <div class="col-span-2">
                    <input
                      type="text"
                      pInputText
                      placeholder="Buscar asesor..."
                      class="w-full"
                    />
                  </div>
                  <!-- <p-select [options]="[]" placeholder="Todos"></p-select>
                <p-select [options]="[]" placeholder="Todos"></p-select> -->
                </div>

                <p-accordion [value]="0">
                  @for (tab of listaAsesores; track tab.name) {
                  <p-accordion-panel [value]="tab.id">
                    <p-accordion-header
                      ><span class="flex items-center gap-2 w-full">
                        <p-avatar [image]="tab.avatarUrl" shape="circle" />
                        <span class="font-bold whitespace-nowrap">{{
                          tab.name
                        }}</span>
                      </span></p-accordion-header
                    >
                    <p-accordion-content>
                      <div class="flex-col">
                        <div class="border-b border-gray-300 py-2">
                          <p class="text-base text-gray-500">
                            {{ tab.email }}
                          </p>
                          <!-- <p class="text-base text-gray-500">
                            {{ tab.celular }}
                          </p> -->
                        </div>
                        <div class="border-b border-gray-300 py-2">
                          <p class="font-semibold mb-2">Canales Activos:</p>

                          <ul
                            class="grid grid-cols-2 text-sm space-y-2"
                            *ngIf="tab.inboxes?.length > 0; else sinCanales"
                          >
                            <li
                              class="flex items-center gap-2"
                              *ngFor="let itemInbox of tab.inboxes"
                            >
                              <iconify-icon
                                [icon]="'icon-park-outline:check-one'"
                                class="text-lg text-green-500"
                              ></iconify-icon>
                              <span>{{ itemInbox.name }}</span>
                            </li>
                          </ul>

                          <!-- Plantilla alternativa si está vacío -->
                          <ng-template #sinCanales>
                            <p class="text-sm text-gray-500 italic">
                              Aún no tiene asignado ningún canal.
                            </p>
                          </ng-template>
                        </div>
                        <div class="border-b border-gray-300 py-4">
                          <div class="flex justify-between items-center">
                            <div>
                              <p class="text-lg font-semibold">Estado:</p>
                            </div>
                            <div>
                              <p-tag
                                [value]="tab.estado"
                                [severity]="
                                  tab.estado == 'En Llamada'
                                    ? 'success'
                                    : tab.estado == 'Fuera de Línea'
                                    ? 'warn'
                                    : tab.estado == 'Disponible'
                                    ? 'info'
                                    : 'danger'
                                "
                                class="text-xs"
                              />
                            </div>
                            <div>
                              <p-button
                                size="small"
                                label="Cambiar"
                                styleClass="w-full !rounded-full !shadow-none"
                                severity="info"
                                variant="outlined"
                                (click)="modalCambiarEstado(tab)"
                              >
                                <iconify-icon
                                  [icon]="'ooui:recent-changes-ltr'"
                                  class="text-lg"
                                />
                              </p-button>
                            </div>
                          </div>
                        </div>
                        <div class="flex items-center pt-4 gap-4">
                          <p-button
                            size="small"
                            label="Asignar Canal"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="info"
                            variant="outlined"
                            (click)="modalAsignarCanal(tab)"
                          >
                            <iconify-icon
                              [icon]="
                                'material-symbols:assignment-turned-in-outline-rounded'
                              "
                              class="text-xl"
                            />
                          </p-button>
                          <p-button
                            size="small"
                            label="Ver historial"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="contrast"
                            variant="outlined"
                            (onClick)="modalVerHistorial(tab.asesor)"
                          >
                            <iconify-icon
                              [icon]="'weui:eyes-on-outlined'"
                              class="text-xl"
                            />
                          </p-button>
                        </div>
                      </div>
                    </p-accordion-content>
                  </p-accordion-panel>
                  }
                </p-accordion>
              </p-card>
            </div>
            <div class="col-span-4">
              <p-card>
                <ng-template pTemplate="title">
                  <div class="text-lg font-semibold">
                    Asignación Actual - Canal: Email
                  </div>
                </ng-template>
                <ng-template pTemplate="content">
                  <p class="text-sm text-gray-500 mb-4">
                    Gestiona los turnos y la cola de Emails.
                  </p>

                  <!-- Lista Turnos -->
                  <div
                    *ngFor="let item of listaTurnos"
                    class="mb-6 rounded-xl border border-gray-300 p-4"
                  >
                    <div class="flex items-center justify-between mb-4">
                      <h3 class="font-semibold">{{ item.turno }}</h3>
                      <p-button
                        size="small"
                        label="Configurar"
                        [raised]="true"
                        styleClass="w-full"
                        severity="info"
                      >
                        <iconify-icon
                          [icon]="'solar:settings-linear'"
                          class="text-xl"
                        />
                      </p-button>
                    </div>
                    <div
                      class="space-y-2"
                      *ngIf="item.asesores.length > 0; else sinAsesores"
                    >
                      <!-- Asesores -->
                      <div
                        *ngFor="let asesor of item.asesores"
                        class="flex items-center justify-between p-3 border rounded-md border-gray-300"
                      >
                        <div class="flex items-center gap-2">
                          <p-badge
                            [severity]="
                              asesor.estado == 'En Llamada'
                                ? 'success'
                                : asesor.estado == 'Fuera de Línea'
                                ? 'warn'
                                : asesor.estado == 'Disponible'
                                ? 'info'
                                : 'danger'
                            "
                          />
                          <span>{{ asesor.asesor }}</span>
                        </div>
                        <div class="flex items-center gap-3">
                          <p-tag
                            [value]="asesor.estado"
                            [severity]="
                              asesor.estado == 'En Llamada'
                                ? 'success'
                                : asesor.estado == 'Fuera de Línea'
                                ? 'warn'
                                : asesor.estado == 'Disponible'
                                ? 'info'
                                : 'danger'
                            "
                            class="text-xs"
                          />
                          <p-button
                            size="small"
                            label="Cambiar"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="info"
                            variant="outlined"
                            (click)="modalCambiarEstado(asesor)"
                          >
                            <iconify-icon
                              [icon]="'ooui:recent-changes-ltr'"
                              class="text-lg"
                            />
                          </p-button>
                        </div>
                      </div>
                    </div>
                    <ng-template #sinAsesores>
                      <div
                        class="flex items-center justify-between p-3 border border-gray-400 rounded-md text-gray-300 italic"
                      >
                        <div class="flex items-center gap-2">
                          <span class="w-2 h-2 rounded-full bg-gray-400"></span>
                          <span>(Vacante)</span>
                        </div>
                        <p-button
                          size="small"
                          label="Asignar"
                          styleClass="w-full"
                          severity="secondary"
                          variant="outlined"
                        >
                          <iconify-icon
                            [icon]="'pajamas:assignee'"
                            class="text-lg"
                          />
                        </p-button>
                      </div>
                    </ng-template>
                  </div>
                </ng-template>
              </p-card>

              <!-- <p-card class="mt-4">
              <ng-template pTemplate="title">
                <div class="text-lg font-semibold">
                  Cola Actual - Canal: Telefónico
                </div>
              </ng-template>
              <ng-template pTemplate="content">
                <p class="text-sm text-gray-500 mb-4">
                  Monitoreo en tiempo real de llamadas en espera
                </p>
                <div
                  *ngFor="let item of listaTurnos"
                  class="mb-6 rounded-xl border border-gray-300 p-4"
                ></div>
              </ng-template>
            </p-card> -->
            </div>
          </div>
        </p-tabpanel>
        <p-tabpanel [value]="3">
          <div class="grid grid-cols-6 gap-6">
            <div class="col-span-2">
              <p-card>
                <h3 class="text-xl font-bold">Asesores Disponibles</h3>
                <p class="text-sm mb-4">
                  Gestiona el estado y asignación de tus asesores
                </p>
                <div class="grid grid-cols-2 items-center gap-4 mb-6">
                  <div class="col-span-2">
                    <input
                      type="text"
                      pInputText
                      placeholder="Buscar asesor..."
                      class="w-full"
                    />
                  </div>
                  <!-- <p-select [options]="[]" placeholder="Todos"></p-select>
                <p-select [options]="[]" placeholder="Todos"></p-select> -->
                </div>

                <p-accordion [value]="0">
                  @for (tab of listaAsesores; track tab.name) {
                  <p-accordion-panel [value]="tab.id">
                    <p-accordion-header
                      ><span class="flex items-center gap-2 w-full">
                        <p-avatar [image]="tab.avatarUrl" shape="circle" />
                        <span class="font-bold whitespace-nowrap">{{
                          tab.name
                        }}</span>
                      </span></p-accordion-header
                    >
                    <p-accordion-content>
                      <div class="flex-col">
                        <div class="border-b border-gray-300 py-2">
                          <p class="text-base text-gray-500">
                            {{ tab.email }}
                          </p>
                          <!-- <p class="text-base text-gray-500">
                            {{ tab.celular }}
                          </p> -->
                        </div>
                        <div class="border-b border-gray-300 py-2">
                          <p class="font-semibold mb-2">Canales Activos:</p>

                          <ul
                            class="grid grid-cols-2 text-sm space-y-2"
                            *ngIf="tab.inboxes?.length > 0; else sinCanales"
                          >
                            <li
                              class="flex items-center gap-2"
                              *ngFor="let itemInbox of tab.inboxes"
                            >
                              <iconify-icon
                                [icon]="'icon-park-outline:check-one'"
                                class="text-lg text-green-500"
                              ></iconify-icon>
                              <span>{{ itemInbox.name }}</span>
                            </li>
                          </ul>

                          <!-- Plantilla alternativa si está vacío -->
                          <ng-template #sinCanales>
                            <p class="text-sm text-gray-500 italic">
                              Aún no tiene asignado ningún canal.
                            </p>
                          </ng-template>
                        </div>
                        <div class="border-b border-gray-300 py-4">
                          <div class="flex justify-between items-center">
                            <div>
                              <p class="text-lg font-semibold">Estado:</p>
                            </div>
                            <div>
                              <p-tag
                                [value]="tab.estado"
                                [severity]="
                                  tab.estado == 'En Llamada'
                                    ? 'success'
                                    : tab.estado == 'Fuera de Línea'
                                    ? 'warn'
                                    : tab.estado == 'Disponible'
                                    ? 'info'
                                    : 'danger'
                                "
                                class="text-xs"
                              />
                            </div>
                            <div>
                              <p-button
                                size="small"
                                label="Cambiar"
                                styleClass="w-full !rounded-full !shadow-none"
                                severity="info"
                                variant="outlined"
                                (click)="modalCambiarEstado(tab)"
                              >
                                <iconify-icon
                                  [icon]="'ooui:recent-changes-ltr'"
                                  class="text-lg"
                                />
                              </p-button>
                            </div>
                          </div>
                        </div>
                        <div class="flex items-center pt-4 gap-4">
                          <p-button
                            size="small"
                            label="Asignar Canal"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="info"
                            variant="outlined"
                            (click)="modalAsignarCanal(tab)"
                          >
                            <iconify-icon
                              [icon]="
                                'material-symbols:assignment-turned-in-outline-rounded'
                              "
                              class="text-xl"
                            />
                          </p-button>
                          <p-button
                            size="small"
                            label="Ver historial"
                            styleClass="w-full !rounded-full !shadow-none"
                            severity="contrast"
                            variant="outlined"
                            (onClick)="modalVerHistorial(tab.asesor)"
                          >
                            <iconify-icon
                              [icon]="'weui:eyes-on-outlined'"
                              class="text-xl"
                            />
                          </p-button>
                        </div>
                      </div>
                    </p-accordion-content>
                  </p-accordion-panel>
                  }
                </p-accordion>
              </p-card>
            </div>
            <div class="col-span-4">
              <!-- <div class="mb-4">
              <p-card class="mt-4">
                <ng-template pTemplate="title">
                  <h3 class="text-xl font-bold">Cola de Mensajes: WhatsApp</h3>
                  <p class="text-sm font-normal mb-4">
                    Mensajes pendientes de asignación
                  </p>
                </ng-template>
                <ng-template pTemplate="content">
                  <div>
                    <p-table
                      [value]="listadoLlamadasEspera"
                      [paginator]="true"
                      [rows]="10"
                      [responsiveLayout]="'scroll'"
                      [rowsPerPageOptions]="[5, 10, 20]"
                      [showCurrentPageReport]="true"
                      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} entradas"
                    >
                      <ng-template pTemplate="header">
                        <tr>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Id
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Contribuyente
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Categoria
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex justify-center items-center text-xs uppercase gap-4"
                            >
                              Tiempo de cola
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex justify-center items-center text-xs uppercase gap-4"
                            >
                              Acciones
                            </div>
                          </th>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="body" let-item>
                        <tr>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.id }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.contribuyente }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.category }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light text-center">
                              {{ item.tiempoCola }}
                            </p>
                          </td>
                          <td></td>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="emptymessage">
                        <tr>
                          <td colspan="7" class="text-center p-6">
                            <div
                              class="flex flex-col items-center text-gray-500"
                            >
                              <i
                                class="pi pi-folder-open text-6xl text-gray-400"
                              ></i>
                              <p class="text-lg font-medium mt-3">
                                Sin Llamadas en espera
                              </p>
                            </div>
                          </td>
                        </tr>
                      </ng-template>
                    </p-table>
                  </div>
                </ng-template>
              </p-card>
            </div> -->

              <div>
                <p-card class="mt-4">
                  <ng-template pTemplate="title">
                    <h3 class="text-xl font-bold">Configuración del Canal</h3>
                    <p class="text-sm font-normal mb-2">
                      Ajustes para el canal de telegram
                    </p>
                  </ng-template>
                  <ng-template pTemplate="content">
                    <div class="space-y-2 mb-2">
                      <div class="flex justify-between items-center">
                        <div class="flex items-center">
                          <iconify-icon [icon]="'bi:chat'" class="text-sm" />
                          <span class="font-medium text-sm ml-2"
                            >Respuestas Automáticas</span
                          >
                        </div>
                        <p-toggleswitch [(ngModel)]="checked" />
                      </div>
                      <div class="flex justify-between items-center">
                        <div class="flex items-center">
                          <iconify-icon [icon]="'uiw:date'" class="text-sm" />
                          <span class="font-medium text-sm ml-2"
                            >Horario de Atención</span
                          >
                        </div>
                        <p-toggleswitch [(ngModel)]="checked" />
                      </div>
                      <div>
                        <p class="text-sm text-gray-400">
                          Horario actual: L-V 9:00 AM - 6:00 PM
                        </p>
                      </div>
                      <!-- <div>
                      <p-button
                        size="small"
                        label="Configurar Horario"
                        [raised]="true"
                        severity="info"
                        variant="outlined"
                      >
                        <iconify-icon
                          [icon]="'solar:settings-linear'"
                          class="text-xl"
                        />
                      </p-button>
                    </div> -->
                    </div>
                  </ng-template>
                </p-card>
              </div>
            </div>
          </div>
        </p-tabpanel>
        <p-tabpanel [value]="4">
          <div class="grid grid-cols-6 gap-6">
            <div class="col-span-2">
              <p-card>
                <h3 class="text-xl font-bold">Asesores Disponibles</h3>
                <p class="text-sm mb-4">
                  Gestiona el estado y asignación de tus asesores
                </p>
                <div class="grid grid-cols-2 items-center gap-4 mb-6">
                  <div class="col-span-2">
                    <input
                      type="text"
                      pInputText
                      placeholder="Buscar asesor..."
                      class="w-full"
                    />
                  </div>
                  <!-- <p-select [options]="[]" placeholder="Todos"></p-select>
                <p-select [options]="[]" placeholder="Todos"></p-select> -->
                </div>

                <p-accordion [value]="0">
                  @for (tab of listaAsesores; track tab.name) {
                  <p-accordion-panel [value]="tab.id">
                    <p-accordion-header
                      ><span class="flex items-center gap-2 w-full">
                        <p-avatar [image]="tab.avatarUrl" shape="circle" />
                        <span class="font-bold whitespace-nowrap">{{
                          tab.name
                        }}</span>
                      </span></p-accordion-header
                    >
                    <p-accordion-content>
                      <div class="flex-col">
                        <div class="border-b border-gray-300 py-2">
                          <p class="text-base text-gray-500">
                            {{ tab.email }}
                          </p>
                          <!-- <p class="text-base text-gray-500">
                          {{ tab.celular }}
                        </p> -->
                        </div>
                        <div class="border-b border-gray-300 py-2">
                          <p class="font-semibold mb-2">Canales Activos:</p>

                          <ul
                            class="grid grid-cols-2 text-sm space-y-2"
                            *ngIf="tab.inboxes?.length > 0; else sinCanales"
                          >
                            <li
                              class="flex items-center gap-2"
                              *ngFor="let itemInbox of tab.inboxes"
                            >
                              <iconify-icon
                                [icon]="'icon-park-outline:check-one'"
                                class="text-lg text-green-500"
                              ></iconify-icon>
                              <span>{{ itemInbox.name }}</span>
                            </li>
                          </ul>

                        <!-- Plantilla alternativa si está vacío -->
                        <ng-template #sinCanales>
                          <p class="text-sm text-gray-500 italic">
                            Aún no tiene asignado ningún canal.
                          </p>
                        </ng-template>
                      </div>
                      <div class="border-b border-gray-300 py-4">
                        <div class="flex justify-between items-center">
                          <div>
                            <p class="text-lg font-semibold">Estado:</p>
                          </div>
                          <div>
                            <p-tag
                              [value]="tab.estado"
                              [severity]="
                                tab.estado == 'En llamada'
                                  ? 'success'
                                  : tab.estado == 'Fuera de Línea'
                                  ? 'warn'
                                  : tab.estado == 'Disponible'
                                  ? 'info'
                                  : 'danger'
                              "
                              class="text-xs"
                            />
                          </div>
                          <div>
                            <p-button
                              size="small"
                              label="Cambiar"
                              styleClass="w-full !rounded-full !shadow-none"
                              severity="info"
                              variant="outlined"
                              (click)="modalCambiarEstado(tab)"
                            >
                              <iconify-icon
                                [icon]="'ooui:recent-changes-ltr'"
                                class="text-lg"
                              />
                            </p-button>
                          </div>
                        </div>
                      </div>
                      <div class="flex items-center pt-4 gap-4">
                        <p-button
                          size="small"
                          label="Asignar Canal"
                          styleClass="w-full !rounded-full !shadow-none"
                          severity="info"
                          variant="outlined"
                          (click)="modalAsignarCanal(tab)"
                        >
                          <iconify-icon
                            [icon]="
                              'material-symbols:assignment-turned-in-outline-rounded'
                            "
                            class="text-xl"
                          />
                        </p-button>
                        <p-button
                          size="small"
                          label="Ver historial"
                          styleClass="w-full !rounded-full !shadow-none"
                          severity="contrast"
                          variant="outlined"
                          (onClick)="modalVerHistorial(tab.asesor)"
                        >
                          <iconify-icon
                            [icon]="'weui:eyes-on-outlined'"
                            class="text-xl"
                          />
                        </p-button>
                      </div>
                    </div>
                  </p-accordion-content>
                </p-accordion-panel>
                }
              </p-accordion>
            </p-card>
          </div>
          <div class="col-span-4">
            <!-- <div class="mb-4">
              <p-card class="mt-4">
                <ng-template pTemplate="title">
                  <h3 class="text-xl font-bold">Cola de Mensajes: Telegram</h3>
                  <p class="text-sm font-normal mb-4">
                    Mensajes pendientes de asignación
                  </p>
                </ng-template>
                <ng-template pTemplate="content">
                  <div>
                    <p-table
                      [value]="listadoLlamadasEspera"
                      [paginator]="true"
                      [rows]="10"
                      [responsiveLayout]="'scroll'"
                      [rowsPerPageOptions]="[5, 10, 20]"
                      [showCurrentPageReport]="true"
                      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} entradas"
                    >
                      <ng-template pTemplate="header">
                        <tr>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Id
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Contribuyente
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex items-center text-xs uppercase gap-4"
                            >
                              Categoria
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex justify-center items-center text-xs uppercase gap-4"
                            >
                              Tiempo de cola
                            </div>
                          </th>
                          <th>
                            <div
                              class="flex justify-center items-center text-xs uppercase gap-4"
                            >
                              Acciones
                            </div>
                          </th>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="body" let-item>
                        <tr>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.id }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.contribuyente }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light">
                              {{ item.category }}
                            </p>
                          </td>
                          <td>
                            <p class="text-sm font-light text-center">
                              {{ item.tiempoCola }}
                            </p>
                          </td>
                          <td></td>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="emptymessage">
                        <tr>
                          <td colspan="7" class="text-center p-6">
                            <div
                              class="flex flex-col items-center text-gray-500"
                            >
                              <i
                                class="pi pi-folder-open text-6xl text-gray-400"
                              ></i>
                              <p class="text-lg font-medium mt-3">
                                Sin Llamadas en espera
                              </p>
                            </div>
                          </td>
                        </tr>
                      </ng-template>
                    </p-table>
                  </div>
                </ng-template>
              </p-card>
            </div> -->

              <div>
                <p-card class="mt-4">
                  <ng-template pTemplate="title">
                    <h3 class="text-xl font-bold">Configuración del Canal</h3>
                    <p class="text-sm font-normal mb-2">
                      Ajustes para el canal de telegram
                    </p>
                  </ng-template>
                  <ng-template pTemplate="content">
                    <div class="space-y-2 mb-2">
                      <div class="flex justify-between items-center">
                        <div class="flex items-center">
                          <iconify-icon [icon]="'bi:chat'" class="text-sm" />
                          <span class="font-medium text-sm ml-2"
                            >Respuestas Automáticas</span
                          >
                        </div>
                        <p-toggleswitch [(ngModel)]="checked" />
                      </div>
                      <div class="flex justify-between items-center">
                        <div class="flex items-center">
                          <iconify-icon [icon]="'uiw:date'" class="text-sm" />
                          <span class="font-medium text-sm ml-2"
                            >Horario de Atención</span
                          >
                        </div>
                        <p-toggleswitch [(ngModel)]="checked" />
                      </div>
                      <div>
                        <p class="text-sm text-gray-400">
                          Horario actual: L-V 9:00 AM - 6:00 PM
                        </p>
                      </div>
                      <!-- <div>
                      <p-button
                        size="small"
                        label="Configurar Horario"
                        [raised]="true"
                        severity="info"
                        variant="outlined"
                      >
                        <iconify-icon
                          [icon]="'solar:settings-linear'"
                          class="text-xl"
                        />
                      </p-button>
                    </div> -->
                    </div>
                  </ng-template>
                </p-card>
              </div>
            </div>
          </div>
        </p-tabpanel>
      </p-tabpanels>
    </p-tabs>
  </ng-container>
</div>

<!-- Modal Asiganar Canal -->
<p-dialog
  [(visible)]="displayAsignarCanal"
  [modal]="true"
  [header]="'Asignar canales a ' + this.asesorSeleccionado"
  [dismissableMask]="true"
  [style]="{ width: '450px' }"
>
  <div>
    <div class="text-sm space-y-4 p-2">
      <div class="flex justify-between">
        <span class="font-medium">Telefónico</span
        ><p-toggleswitch [(ngModel)]="checked" />
      </div>
      <!-- <div class="flex justify-between">
        <span class="font-medium">DNI:</span
        ><p-toggleswitch [(ngModel)]="checked" />
      </div> -->
      <div class="flex justify-between">
        <span class="font-medium">ChatSAT</span
        ><p-toggleswitch [(ngModel)]="checked" />
      </div>
      <div class="flex justify-between">
        <span class="font-medium">Email</span
        ><p-toggleswitch [(ngModel)]="checked" />
      </div>
      <div class="flex justify-between">
        <span class="font-medium">WhatsApp</span
        ><p-toggleswitch [(ngModel)]="checked" />
      </div>
      <div class="flex justify-between">
        <span class="font-medium">Telegram</span
        ><p-toggleswitch [(ngModel)]="checked" />
      </div>
    </div>
    <div class="flex justify-self-end pt-4 gap-4">
      <p-button
        size="small"
        label="Cerrar"
        styleClass="w-full"
        severity="contrast"
        (click)="displayAsignarCanal = false"
      >
        <iconify-icon [icon]="'ix:cancel'" class="text-xl" />
      </p-button>
      <p-button
        size="small"
        label="Guardar"
        styleClass="w-full"
        severity="info"
      >
        <iconify-icon [icon]="'ci:save'" class="text-xl" />
      </p-button>
    </div>
  </div>
</p-dialog>

<!-- Modal Ver Historial -->
<p-dialog
  [(visible)]="displayVerHistorial"
  [modal]="true"
  [header]="'Historial de ' + this.asesorSeleccionado"
  [dismissableMask]="true"
  [style]="{ width: '900px' }"
>
  <div>
    <div>
      <p-tabs [value]="value">
        <p-tablist>
          <p-tab [value]="0"> <span>Rendimiento</span></p-tab>
          <p-tab [value]="1"><span>Actividad Reciente</span></p-tab>
        </p-tablist>
        <p-tabpanels>
          <p-tabpanel [value]="0">
            <div class="grid grid-cols-3 gap-4 mt-4">
              <div
                class="border border-gray-400 space-y-2 rounded-lg shadow p-4 hover:bg-gray-100"
              >
                <h3 class="font-bold text-base">Casos Completadoy hoy</h3>
                <h3 class="font-extrabold text-3xl">15</h3>
                <p class="text-sm font-normal">Interacciones resueltas</p>
              </div>
              <div
                class="border border-gray-400 space-y-2 rounded-lg shadow p-4 hover:bg-gray-100"
              >
                <h3 class="font-bold text-base">
                  Tiempo promedio de respuesta
                </h3>
                <h3 class="font-extrabold text-3xl">30 s</h3>
                <p class="text-sm font-normal">En canales activos</p>
              </div>
              <div
                class="border border-gray-400 space-y-2 rounded-lg shadow p-4 hover:bg-gray-100"
              >
                <h3 class="font-bold text-base">Carga de trabajo actual</h3>
                <h3 class="font-extrabold text-3xl">2/5</h3>
                <p class="text-sm font-normal">Interacciones activas</p>
              </div>
            </div>
          </p-tabpanel>
          <p-tabpanel [value]="1">
            <div>
              <p-table
                [value]="listadoInteracciones"
                [paginator]="true"
                [rows]="10"
                [responsiveLayout]="'scroll'"
                [rowsPerPageOptions]="[5, 10, 20]"
                [showCurrentPageReport]="true"
                currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} entradas"
              >
                <ng-template pTemplate="header">
                  <tr>
                    <th>
                      <div class="flex items-center text-xs uppercase gap-4">
                        Id
                      </div>
                    </th>
                    <th>
                      <div class="flex items-center text-xs uppercase gap-4">
                        Tipo
                      </div>
                    </th>
                    <th>
                      <div class="flex items-center text-xs uppercase gap-4">
                        Contribuyente
                      </div>
                    </th>
                    <th>
                      <div
                        class="flex justify-center items-center text-xs uppercase gap-4"
                      >
                        Estado
                      </div>
                    </th>
                    <th>
                      <div
                        class="flex justify-center items-center text-xs uppercase gap-4"
                      >
                        Ultima activiad
                      </div>
                    </th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                  <tr>
                    <td>
                      <p class="text-sm font-light">{{ item.id }}</p>
                    </td>
                    <td>
                      <p class="text-sm font-light">{{ item.tipo }}</p>
                    </td>
                    <td class="text-center">
                      <p class="text-sm font-light">{{ item.contribuyente }}</p>
                    </td>
                    <td>
                      <p class="text-sm font-light text-center">
                        <p-tag
                          [value]="item.estado == true ? 'Activo' : 'Inactivo'"
                          [severity]="
                            item.estado == true ? 'success' : 'danger'
                          "
                          class="text-xs"
                        />
                      </p>
                    </td>
                    <td>
                      <p class="text-sm font-light text-center">
                        {{ item.fecha }}
                      </p>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr>
                    <td colspan="7" class="text-center p-6">
                      <div class="flex flex-col items-center text-gray-500">
                        <i class="pi pi-folder-open text-6xl text-gray-400"></i>
                        <p class="text-lg font-medium mt-3">Sin Historial</p>
                      </div>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </p-tabpanel>
        </p-tabpanels>
      </p-tabs>
    </div>
    <div class="flex justify-self-end pt-4 gap-4">
      <p-button
        size="small"
        label="Cerrar"
        styleClass="w-full"
        severity="contrast"
        (click)="displayVerHistorial = false"
      >
        <iconify-icon [icon]="'ix:cancel'" class="text-xl" />
      </p-button>
    </div>
  </div>
</p-dialog>

<!-- Modal Cambiar Estado Asesor -->
<p-dialog
  [(visible)]="displayCambiarEstado"
  [modal]="true"
  [header]="'Cambiar estado de ' + this.asesorSeleccionado"
  [dismissableMask]="true"
  [style]="{ width: '400px' }"
>
  <div>
    <div>
      <div class="flex flex-col gap-2">
        <label class="text-sm font-medium" for="idEstado">
          Estado <span class="text-xs">*</span>
        </label>
        <p-select
          id="idEstado"
          [options]="estadosTelefonico"
          [(ngModel)]="this.estadoAsesor"
          optionLabel="name"
          optionValue="id"
          placeholder="Seleccione"
          appendTo="body"
        />
      </div>
    </div>
    <div class="flex justify-self-end pt-4 gap-4">
      <p-button
        size="small"
        label="Cerrar"
        styleClass="w-full"
        severity="contrast"
        (click)="displayCambiarEstado = false"
      >
        <iconify-icon [icon]="'ix:cancel'" class="text-xl" />
      </p-button>
      <p-button
        size="small"
        label="Guardar"
        styleClass="w-full"
        severity="info"
      >
        <iconify-icon [icon]="'ci:save'" class="text-xl" />
      </p-button>
    </div>
  </div>
</p-dialog>
