<div class="grid grid-cols-1 gap-4 px-3">
  <!-- Encabezado -->
  <div class="bg-gray-50 shadow rounded-xl p-4">
    <div class="flex justify-between items-center">
      <div>
        <app-title-sat />
      </div>
      <!-- <button-save
        [label]="createButtonLabel"
        [icon]="'mdi:plus-circle-outline'"
        (click)="addNew()"
      /> -->
    </div>
  </div>

  <div class="">
    <!-- Tabs -->
    <p-tabs
      [(value)]="activeTab"
      (valueChange)="onTabChange($event.toString())"
      class="mb-4"
    >
      <p-tablist>
        <p-tab value="0">Mis atenciones</p-tab>
        <p-tab value="1">Verificaciones de pago</p-tab>
        <!-- <p-tab value="2">Atenciones cerradas</p-tab> -->
      </p-tablist>

      <p-tabpanels>
        <p-tabpanel value="0">
          <ng-container *ngIf="activeTab === '0'">
            <ng-container *ngTemplateOutlet="tablaTickets"></ng-container>
          </ng-container>
        </p-tabpanel>
        <p-tabpanel value="1">
          <ng-container *ngIf="activeTab === '1'">
            <ng-container *ngTemplateOutlet="tablaTickets"></ng-container>
          </ng-container>
        </p-tabpanel>
        <p-tabpanel value="2">
          <ng-container *ngIf="activeTab === '2'">
            <ng-container *ngTemplateOutlet="tablaTickets"></ng-container>
          </ng-container>
        </p-tabpanel>
      </p-tabpanels>
    </p-tabs>

    <!-- Tabla PrimeNG -->
    <ng-template #tablaTickets>
      <p-table
        #dt2
        [value]="filteredTickets"
        selectionMode="single"
        [(selection)]="selectedAtencion"
        dataKey="nombre"
        responsiveLayout="scroll"
        class="p-datatable-sm"
        [paginator]="true"
        [rows]="5"
        [rowsPerPageOptions]="[5, 10, 20]"
        showGridlines
      >
        <!-- <ng-template #caption>
          <div class="flex justify-between">
            <div>
              <p-iconfield iconPosition="left" class="ml-auto">
                <input
                  pInputText
                  type="text"
                  (input)="dt2.filterGlobal($event.target, 'contains')"
                  placeholder="Buscar por palabra clave"
                  class="!rounded-full"
                />
              </p-iconfield>
            </div>
            <div>
              <p-button
                size="small"
                label="Exportar"
                (click)="nuevaAtencion()"
                styleClass="w-full"
                variant="outlined"
                severity="success"
              >
                <iconify-icon [icon]="'ri:file-excel-2-fill'" class="text-xl" />
              </p-button>
            </div>
          </div>
        </ng-template> -->
        <ng-template pTemplate="header">
          <tr class="uppercase">
            <th>
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Fecha/Hora
              </div>
            </th>
            <th>
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Código contribuyente
              </div>
            </th>
            <th>
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Contribuyente
              </div>
            </th>
            <th *ngIf="activeTab != '1'">
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Tipo
              </div>
            </th>
            <th *ngIf="activeTab != '1'">
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Canal
              </div>
            </th>
            <th *ngIf="activeTab != '1'">
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Método
              </div>
            </th>
            <th *ngIf="activeTab != '1'">
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Contacto Usado
              </div>
            </th>
            <th>
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Resultado
              </div>
            </th>
            <th>
              <div
                class="flex justify-center items-center text-xs uppercase gap-4"
              >
                Sectorista
              </div>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
          <tr>
            <td>
              <p class="text-sm text-center font-light">
                {{ item?.createdAt | date : "dd/MM/yyyy hh:ss a" }}
              </p>
            </td>
            <td>
              {{ item.carteraDetalle?.code }}
            </td>
            <td>{{ item.carteraDetalle?.taxpayerName }}</td>
            <!-- <td>{{ item.estado }}</td> -->
            <td *ngIf="activeTab != '1'">
              <p class="text-sm text-center font-light">
                {{ item?.type }}
              </p>
            </td>
            <td *ngIf="activeTab != '1'">
              <p class="text-sm text-center font-light">
                {{ item?.channel }}
              </p>
            </td>
            <td *ngIf="activeTab != '1'">
              <p class="text-sm font-light text-center">
                {{ item?.method }}
              </p>
            </td>
            <td *ngIf="activeTab != '1'">
              <p class="text-sm font-light text-center">
                {{ item?.contact }}
              </p>
            </td>
            <td>
              <p class="text-sm font-light text-center">
                {{ item?.result }}
              </p>
            </td>
            <td>
              <p class="text-sm font-light text-center">
                {{ item?.createdByUser?.name }}
              </p>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </ng-template>
  </div>
</div>
