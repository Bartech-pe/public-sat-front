<p-dialog
  [(visible)]="visible"
  (onHide)="closeModal()"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  [style]="{ width: '400px' }"
  [appendTo]="'body'"
  header="Establecer Prioridad"
>
  <div class="space-y-4">
    <label class="block text-sm font-medium">Selecciona la prioridad:</label>

    <p-dropdown
      [options]="priorityOptions"
      [(ngModel)]="prioritySelected"
      optionLabel="label"
      appendTo="body"
      placeholder="Seleccionar prioridad"
      [showClear]="true"
      styleClass="w-full"
    >
      <ng-template let-priority pTemplate="item">
        <div class="flex items-center gap-3 p-2">
          <i [class]="priority.icon" [style.color]="priority.color"></i>
          <span [ngClass]="getPriorityClass(priority.value)">
            {{ priority.label }}
          </span>
        </div>
      </ng-template>

      <ng-template let-priority pTemplate="selectedItem">
        <div class="flex items-center gap-2" *ngIf="priority">
          <i [class]="priority.icon" [style.color]="priority.color"></i>
          <span [ngClass]="getPriorityClass(priority.value)">
            {{ priority.label }}
          </span>
        </div>
      </ng-template>
    </p-dropdown>

    <!-- Mostrar prioridad actual si existe -->
    <div *ngIf="currentPriority" class="text-sm text-gray-600 bg-gray-50 p-2 rounded">
      <span class="font-medium">Prioridad actual:</span>
      <span [ngClass]="getPriorityClass(currentPriority)" class="ml-2 capitalize">
        {{ currentPriority }}
      </span>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-end gap-2">
      <p-button
        label="Cancelar"
        severity="secondary"
        [text]="true"
        (onClick)="closeModal()"
      ></p-button>
      <p-button
        label="Establecer"
        [disabled]="!prioritySelected"
        (onClick)="onEstablecerPrioridad()"
      ></p-button>
    </div>
  </ng-template>
</p-dialog>
